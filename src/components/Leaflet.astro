---
import { cn } from '../utils/cn'

import type { HTMLAttributes } from 'astro/types'

import 'leaflet/dist/leaflet.css'

type Props = HTMLAttributes<'div'>

const { class: className, ...props } = Astro.props
---

<div id="map" class={cn('h-full w-full', className)} {...props}></div>

<script>
  import L from 'leaflet'

  document.addEventListener('astro:page-load', () => {
    // Initialize map
    const map = L.map('map', { attributionControl: false }).setView([34.778306, 32.418944], 13)

    // Add tile layer
    L.tileLayer('https://tile.openstreetmap.org/{z}/{x}/{y}.png', {
      maxZoom: 19,
      attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',
    }).addTo(map)

    // Fix map size issues if any
    setTimeout(() => {
      map.invalidateSize()
    }, 0)
  })
</script>
